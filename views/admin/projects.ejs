<%- include('header') %>

<div class="page-header">
    <h1><i class="fas fa-project-diagram"></i> Projects Management</h1>
    <button class="btn btn-primary" onclick="showAddForm()">
        <i class="fas fa-plus"></i> Add New Project
    </button>
</div>

<div id="addForm" class="form-card" style="display: none;">
    <h2><span id="formTitle">Add New Project</span></h2>
    <form id="projectForm" action="/admin/projects/add" method="POST">
        <div class="form-group">
            <label>Project Name *</label>
            <input type="text" id="name" name="name" required>
        </div>
        <div class="form-group">
            <label>Description *</label>
            <textarea id="description" name="description" rows="4" required></textarea>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label>Status *</label>
                <select id="status" name="status" required>
                    <option value="Completed">Completed</option>
                    <option value="In Progress">In Progress</option>
                    <option value="Planned">Planned</option>
                </select>
            </div>
            <div class="form-group">
                <label>Year *</label>
                <input type="text" id="year" name="year" placeholder="2025" required>
            </div>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label>Client</label>
                <input type="text" id="client" name="client">
            </div>
            <div class="form-group">
                <label>Location</label>
                <input type="text" id="location" name="location">
            </div>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label>Duration</label>
                <input type="text" id="duration" name="duration" placeholder="12 months">
            </div>
            <div class="form-group">
                <label>Project Value</label>
                <input type="text" id="projectValue" name="projectValue" placeholder="â‚¹50 Crores">
            </div>
        </div>
        <div class="form-group">
            <label>Image URL</label>
            <input type="text" id="image" name="image" placeholder="https://... or /images/filename.jpg">
            <small style="color: #666; font-size: 0.85em; display: block; margin-top: 4px;">Tip: Full URLs work; local paths will auto-convert to <code>/images/filename.jpg</code></small>
        </div>
        <div class="form-group">
            <label>Technologies (comma-separated)</label>
            <input type="text" id="technologies" name="technologies" placeholder="IoT, AI, Cloud">
        </div>
        <div class="form-group">
            <label>Key Achievements (comma-separated)</label>
            <textarea id="keyAchievements" name="keyAchievements" rows="3"></textarea>
        </div>
        <div class="form-actions">
            <button type="submit" class="btn btn-success"><i class="fas fa-save"></i> <span id="submitBtn">Save</span></button>
            <button type="button" class="btn btn-secondary" onclick="hideAddForm()"><i class="fas fa-times"></i> Cancel</button>
        </div>
    </form>
</div>

<div class="data-table">
    <table>
        <thead>
            <tr>
                <th>#</th>
                <th>Name</th>
                <th>Client</th>
                <th>Status</th>
                <th>Year</th>
                <th>Value</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <% projects.forEach((project, index) => { %>
                <tr>
                    <td><%= index + 1 %></td>
                    <td>
                        <strong><%= project.name %></strong>
                        <p class="small-text"><%= project.description.substring(0, 80) %>...</p>
                    </td>
                    <td><%= project.client %></td>
                    <td>
                        <span class="badge <%= project.status === 'Completed' ? 'badge-success' : 'badge-warning' %>">
                            <%= project.status %>
                        </span>
                    </td>
                    <td><%= project.year %></td>
                    <td class="small-text"><%= project.projectValue || 'N/A' %></td>
                    <td>
                        <button class="btn-icon btn-warning" onclick='editProject(<%= index %>, <%- JSON.stringify(project) %>)' title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-icon btn-danger" onclick="deleteItem('projects', <%= index %>)" title="Delete">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            <% }); %>
        </tbody>
    </table>
</div>

<%- include('footer') %>
